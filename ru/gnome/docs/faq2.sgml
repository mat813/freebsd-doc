<!--
     The FreeBSD Russian Documentation Project

     $FreeBSDru: frdp/www/ru/gnome/docs/faq2.sgml,v 1.3 2003/12/13 08:17:51 andy Exp $

     Original revision: 1.48
-->

<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" [
<!ENTITY base CDATA "../../..">
<!ENTITY date "$FreeBSD$">
<!ENTITY title "Проект FreeBSD GNOME: FAQ по GNOME &gnomever;">
<!ENTITY % gnomeincludes SYSTEM "../includes.sgml"> %gnomeincludes;
<!ENTITY % includes SYSTEM "../../includes.sgml"> %includes;
]>
<html>
  &header;

  <h2>Краткое содержание</h2>

  <ol>
    <li> <a href="#q1">Как получить GNOME &gnomever; для FreeBSD?</a>

    <li> <a href="#q2">Построить GNOME &gnomever; из портов не удаётся.
      Что делать?</a>

    <li> <a href="#q3">Я установил GNOME &gnomever;, но там нет приложения foo.
      Где взять?</a>

    <li> <a href="#q4">Как лучше всего выполнить обновление с GNOME 1.4 на
      GNOME 2?</a>

    <li> <a href="#q5">Как лучше всего выполнить обновление с GNOME 2.2 на
      GNOME &gnomever;?</a>

    <li> <a href="#q6">Как обеспечить постоянное наличие современных версий
      компонентов и приложений GNOME &gnomever;?</a>

    <li> <a href="#q7">Могу ли я устанавливать приложения для GNOME 1.4 в
      GNOME &gnomever;?</a>

    <li> <a href="#q8">Где можно найти дополнительные темы для
      GNOME &gnomever;?</a>

    <li> <a href="#q9">Какие оконные менеджеры нормально работают с
      GNOME &gnomever;?</a>

    <li> <a href="#q10">Поддерживает ли GNOME &gnomever; шрифты с
      антиалиасингом?</a>

    <li> <a href="#q11">Как можно контролировать, с какими шрифтами
      используется антиалиасинг?</a>

    <li> <a href="#q12">Как можно отредактировать меню GNOME 2?</a>

    <li> <a href="#q13">Как использовать настройки ресурсов GTK+ 2 с
      приложениями GTK+ 2 при работе вне оболочки GNOME?</a>

    <li> <a href="#q14">Как выполнить настройки для приложений GNOME 1.4 при
      работе в GNOME &gnomever;?</a>

    <li> <a href="#q15">Nautilus-cd-burner не позволяет записывать CD.  Как
      это исправить?</a>

    <li> <a href="#q16">Как добавить новые сеансы GDM?</a>
  </ol>

  <h2>Полный текст</h2> 

  <ol>
<!-- Q1 -->
    <li style="padding-bottom: 0.5em"><a name="q1"></a>
      <p><b>Как получить GNOME &gnomever; для FreeBSD?</b></p>

<!-- A1 -->
      <p>Имеются два способа установки GNOME &gnomever; во FreeBSD.  Первым
        способом является использование <a
        href="http://www.freebsd.org/doc/en_US.ISO8859-1/books/handbook/packages-using.html">
        пакаджей</a>, а вторым использование <a
        href="http://www.freebsd.org/doc/en_US.ISO8859-1/books/handbook/ports-using.html">
        портов</a>.  Перед тем, как выполнять какие-либо установки, сначала вы
        должны ознакомиться с <a
        href="http://www.gnome.org/start/&gnomever;/notes/">замечания о
        релизе</a> GNOME &gnomever;.</p>

      <p>Для установки GNOME &gnomever; из пакаджей воспользуйтесь следующей
        командой:</p>

        <tt># pkg_add -r gnome2</tt>

      <p>Она сгрузит последние пакаджи GNOME &gnomever; с FTP-сервера FreeBSD
        и выполнит их установку в вашу систему.</p>

      <p>Для построения и установки GNOME &gnomever; из портов, вы должны
        сначала сгрузить при помощи <a
        href="http://www.freebsd.org/doc/en_US.ISO8859-1/books/handbook/cvsup.html">
        cvsup</a> последнее состояние дерева портов.  Затем:</p>

      <pre>
# cd /usr/ports/x11/gnome2
# make clean
# make install clean
      </pre>

      <p>Для получения наилучшего результата от GNOME 2 вы должны выполнять
        установку из портов, после добавления следующих макросов в ваш файл
        <tt>/etc/make.conf</tt>:</p>

      <pre>
WITH_FAM=	yes
WITH_LAME=	yes
      </pre>

      <p>Макрос <tt>WITH_FAM</tt> включает поддержку менеджера замены файлов,
        который позволяет программе Nautilus обновлять свои списки файлов в
        реальном времени, а всем компонентам GNOME обнаруживать изменения
        файлов настроек без необходимости перезапуска GNOME.  Заметьте, что
        для корректной работы FAM вам также нужно добавить следующую строку в
        файл <tt>/etc/rc.conf</tt>, а затем выполнить перезагрузку:</p>

      <p>Для FreeBSD 4.x:<br>
        <tt>portmap_enable="YES"</tt></p>

      <p>Для FreeBSD 5.x:<br>
        <tt>rpcbind_enable="YES"</tt></p>

      <p><tt>WITH_LAME</tt> добавляет поддержку MP3, что позволяет проигрывать
        MP3 непосредственно из Nautilus.</p>

      <p>На некоторых платформах эти параметры могут привести к ошибкам на
        этапе построения, поэтому по умолчанию они не включены.</p>
    </li>

<!-- Q2 -->
    <li style="padding-bottom: 0.5em"><a name="q2"></a>
      <p><b>Построить GNOME &gnomever; из портов не удаётся.  Что
        делать?</b></p>

<!-- A2 -->
      <p>Основная масса проблем с компиляцией GNOME &gnomever; может быть
        решена путём <a href="#q6">обновления</a> всех необходимых компонентов
        GNOME &gnomever; до последних версий.  Вы можете увидеть сообщения
        об ошибках конфигурации, подобные следующим:</p>

      <pre>
configure: error: *** pkg-config too old; version 0.14 or better required.
      </pre>

      <p>Хотя это может быть указано в другом месте, но сообщение вполне
        понятно: вам нужно обновить pkg-config.  Приложение pkg-config
        находится в порту <tt>devel/pkgconfig</tt>.  После обновления этого
        порта до последней версии эта ошибка исчезнет.</p>
	      
      <p>Вы можете наблюдать ошибки компилятора, связанные с pthreads (&posix;
        threads), типа следующих:</p>

      <pre>
undefined reference to 'strerror_r'
      </pre>

      <p>Для исправления ошибок, связанных с потоками выполнения, вам
        необходимо вкомпилировать в ваше ядро следующее:</p>

      <pre>
options     _KPOSIX_PRIORITY_SCHEDULING
      </pre>

      <p>И в случае, если вы следуете -stable или -current, <b>не задавайте</b>
        <tt>NOLIBC_R</tt> в <tt>/etc/make.conf</tt>.  Если вы это сделали, то
        удалите и перестройте систему.  Если проблемы всё ещё остались,
        пожалуйста, пошлите сообщение на адрес <a
        href="mailto:&email;@FreeBSD.org">&email;@FreeBSD.org</a> с выдачей
        ошибочных компиляций.  Также не помещает включение файла config.log из
        рабочего каталога порта.</p>

      <p>Такие порты, как <tt>devel/pth</tt> и <tt>devel/ngpt</tt> могут также
        приводить к проблемам, связанным с pthread при компиляции GNOME
        &gnomever;.  Если эти порты устанавливать вам не нужно, то
        рекомендуется их удалить.</p>
    </li>

<!-- Q3 -->
    <li style="padding-bottom: 0.5em"><a name="q3"></a>
      <p><b>Я установил GNOME &gnomever;, но там нет приложения foo.  Где
        взять?</b></p>

<!-- A3 -->
      <p>В пакадж <tt>gnome2</tt> включены только основные компоненты и
        несколько дополнительных.  Хотя вы ещё можете запускать <a
        href="#q7">приложения для GNOME 1.4</a> в GNOME &gnomever;, часть
        приложений уже перенесена в GNOME &gnomever;.</p>

      <p>Приложения, которые перенесены, включены в мета-порт
        <tt>gnome2-fifth-toe</tt>.  Отметьте, что некоторые из этих приложений
        находятся на ранних этапах разработки, и могут оказаться не очень
        стабильными.</p>

      <p>Для установки <tt>gnome2-fifth-toe</tt> из пакаджей:</p>

      <pre>
# pkg_add -r gnome2-fifth-toe
      </pre>

      <p>Для установки <tt>gnome2-fifth-toe</tt> из портов:</p>

      <pre>
# cd /usr/ports/x11/gnome2-fifth-toe
# make clean
# make install clean
      </pre>
    </li>

<!-- Q4 -->
    <li style="padding-bottom: 0.5em"><a name="q4"></a>
      <p><b>Как лучше всего выполнить обновление с GNOME 1.4 на
        GNOME 2?</b></p>

<!-- A4 -->
      <p>В настоящее время проект GNOME всё ещё не стабилизировался.  Ещё
        должны быть выполнены работы в инфраструктуре портов GNOME для того,
        чтобы всё чисто срабатывало.  Однако если вы используете GNOME 1.4 и
        хотите обновить её до GNOME &gnomever;, то сначала ознакомьтесь с <a
        href="http://www.gnome.org/start/2.0/installation.html#upgrading">
        официальными</a> инструкциями по обновлению на сайте GNOME.  Затем
        удостоверьтесь, что ваши порты GNOME 1.4 обновлены до последних версий,
        после чего удалите из системы следующие пакаджи GNOME 1.4:</p>
	    
      <pre>
gnomecore
sawfish
gnomeapplets 
gnomemedia
gtop
libgtop
nautilus
gedit
xalf
bugbuddy
gnomeaudio
gnomegames
gnomeutils
gdm
eog
ggv
      </pre>

      <p>После удаления этих пакаджей вы можете построить GNOME &gnomever; в
        соответствии с инструкциями выше.</p>
    </li>

<!-- Q5 -->
    <li style="padding-bottom: 0.5em"><a name="q5"></a>
      <p><b>Как лучше всего выполнить обновление с GNOME 2.2 на
        GNOME &gnomever;?</b></p>

<!-- A5 -->
      <p>Для этой цели мы рекомендуем использовать порт
        <tt>/usr/ports/sysutils/portupgrade</tt>.  Он следает всё так, как
        нужно:</p>

      <pre>
# pkgdb -F
(ответить yes на все запросы)
# portupgrade ORBit2 libbonobo
# portupgrade -rf -m BATCH=yes atk
# portupgrade -R -m BATCH=yes gnome2
      </pre>
    </li>

<!-- Q6 -->
    <li style="padding-bottom: 0.5em"><a name="q6"></a>
      <p><b>Как обеспечить постоянное наличие современных версий
        компонентов и приложений GNOME &gnomever;?</b></p>

<!-- A6 -->
      <p>Я обнаружил, что <tt>/usr/ports/sysutils/portupgrade</tt> работает
        достаточно хорошо.  К примеру:</p>

        <tt># portupgrade -r pkgconfig</tt>

      <p>При этом будет обновлён pkgconfig и все остальные порты, которые
        от него зависят (и требуют обновления).</p>

      <p>Однако иногда такие большие изменения, которые становятся
        необходимыми, требуют предварительной зачистки.  В этом случае вот это
        обычно срабатывает:</p>

      <pre>
# pkg_delete -rf pkgconfig\*
# cd /usr/ports/x11/gnome2
# make clean
# make install clean
      </pre>

      <p>Эти шаги удалят <b>все</b> компоненты и приложения GNOME 1 и 2 с
        вашей машины, и только переустановят оболочку GNOME 2.  Однако вы
        должны знать, что если до этого дойдёт, то после переустановки оболочки
        вам нужно переустановить ваши приложения.  К счастью, этот решительный
        шаг требуется редко.</p>
    </li>

<!-- Q7 -->
    <li style="padding-bottom: 0.5em"><a name="q7"></a>
      <p><b>Могу ли я устанавливать приложения для GNOME 1.4 в
        GNOME &gnomever;?</b></p>

<!-- A7 -->
      <p>Порты для GNOME 1.4 будут нормально работать с оболочкой GNOME 2.
        Старые приложения, которые были несовместимы с оболочкой GNOME 2, были
        удалены из дерева портов, так что в оболочке GNOME 2 можно без опаски
        запускать любые приложения GNOME из дерева портов.</p>
    </li>

<!-- Q8 -->
    <li style="padding-bottom: 0.5em"><a name="q8"></a>
      <p><b>Где можно найти дополнительные темы для
        GNOME &gnomever;?</b></p>

<!-- A8 -->
      <p>Сайт <a href="http://art.gnome.org">art.gnome.org</a> задумывался как
        общее хранилище тем GNOME.  Там есть некоторые темы для gtk+-2,
        metacity, sawfish, nautilus, icon, и gdm, а также изображения для
        фона.</p>

      <p>Недавно был запущен новый сайт тем под названием <a
        href="http://www.themedepot.org">The Theme Depot</a>.  Он содержит темы
        для GNOME 2, а также KDE и нескольких менеджеров окон.</p>
	    
      <p>На сайте Freshmeat.net находится архив тем по адресу <a
        href="http://themes.freshmeat.net">themes.freshmeat.net</a>, где есть
        темы и фоновые изображения для многих оконных менеджеров, механизмов
        тем и оболочек.  Этот сайт вырос из старого themes.org.</p>

      <p>Хорошим сайтом с некоторым количеством иконок GNOME (часть из них
        новые, часть стандартные) является сайт <a
        href="http://jimmac.musichall.cz/ikony.php3">Icons</a>, который ведёт
        jimmac.</p>

      <p>Инструкции по установке тем можно посмотреть на сайте.  Если вы
        чувствуете, что склоняетесь к тому, чтобы спортировать некоторые из
        них, то вас не отвергнут ;-).</p>
    </li>

<!-- Q9 -->
    <li style="padding-bottom: 0.5em"><a name="q9"></a>
      <p><b>Какие оконные менеджеры нормально работают с
        GNOME &gnomever;?</b></p>

<!-- A9 -->
      <p>По умолчанию мета-порт <tt>gnome2</tt> устанавливает оконный менеджер
        metacity.  Другим популярным менеджером окон, который хорошо работает с
        GNOME &gnomever;, является <a href="http://sawmill.sourceforge.net/">
        sawfish</a>.  Sawfish распространяется как часть мета-порта
	<tt>x11/gnome2-fifth-toe</tt>.

      <p>Для того, чтобы перейти с metacity на sawfish в GNOME 2, вам нужно
        сделать следующее:</p>

      <pre>
killall metacity; sawfish &
gnome-session-save --gui
      </pre>

      <p>Команда <tt>gnome-session-save</tt> важна.  Без неё при следующей
        регистрации в системе будет возвращён оконный менеджер, настроенный
        ранее.  Чтобы возвратить настройки обратно, просто замените в команде
        sawfish на metacity.</p>
    </li>

<!-- Q10 -->
    <li style="padding-bottom: 0.5em"><a name="q10"></a>
      <p><b>Поддерживает ли GNOME &gnomever; шрифты с
        антиалиасингом?</b></p>

<!-- A10 -->
      <p>Да!  Использование антиалиасинга требует XFree86 4.x с поддержкой
        freetype2.  Для того, чтобы добавить в X поддержку freetype2,
        обеспечьте загрузку следующих модулей в файле XF86Config в разделе
        Modules:</p>

      <pre>
Load	"freetype"
Load	"type1"
      </pre>
		
      <p>После этого просто проверьте капплету Fonts в
        Applications->Desktop Preferences.  Если вы хотите для начала иметь
        хороший набор шрифтов TrueType, установите порт
        <tt>x11-fonts/webfonts</tt>.</p>

      <p>Иногда, после установки новых шрифтов в систему, необходимо указать
        на них утилите fontconfig.  Если вы обнаружите, что недавно добавленные
        шрифты недоступны даже после перезапуска GNOME 2, запустите следующую
        команду, работая как пользователь root.</p>

      <pre>
# fc-cache -f -v
      </pre>

      <p>Если у вас есть какие-либо вопросы, пожалуйста, присылайте их на адрес
        <a href="mailto:&email;@FreeBSD.org">&email;@FreeBSD.org</a>.</p>
    </li>

<!-- Q11 -->
    <li style="padding-bottom: 0.5em"><a name="q11"></a>
      <p><b>Как можно контролировать, с какими шрифтами
        используется антиалиасинг?</b></p>

<!-- A11 -->
      <p>GNOME &gnomever; для работы с антиалиасингом использует Xft и
        fontconfig.  Fontconfig является очень мощным пакетом для настройки
        шрифтов на основе XML.  Вы можете создать файл <tt>~/.fonts.conf</tt>,
        который будет управлять практически всеми аспектами утилиты fontconfig.
        К примеру, если вы не хотите применять антиалиасинг к шрифтам, меньшим
        чем 16 пунктов, создайте <tt>~/.fonts.conf</tt> со следующим
        содержимым:</p>

      <pre>
&lt;?xml version="1.0"?&gt;
&lt;!DOCTYPE fontconfig SYSTEM "fonts.dtd"&gt;
&lt;fontconfig&gt;

&lt;match target="font"&gt;
        &lt;test name="size" compare="less_eq"&gt;
                &lt;double&gt;16&lt;/double&gt;
        &lt;/test&gt;
        &lt;edit name="antialias" mode="assign"&gt;
                &lt;bool&gt;false&lt;/bool&gt;
        &lt;/edit&gt;
&lt;/match&gt;
&lt;/fontconfig&gt;
      </pre>

      <p>Обратитесь к fonts-conf(5) для получения дополнительной
        информации.</p>
    </li>

<!-- Q12 -->
    <li style="padding-bottom: 0.5em"><a name="q12"></a>
      <p><b>Как можно отредактировать меню GNOME 2?</b></p>

<!-- A12 -->
      <p>Для редактирования меню нужно использовать Nautilus.  Если вы хотите
        отредактировать какое-либо меню (но не Favorites), вы должны работать
        как пользователь root.</p>

      <p>Для редактирования меню запустите Nautilus и введите URL 
        <b>applications:///</b>.  Отсюда вы должны суметь отредактировать
        ваше меню приложений.</p>
    </li>

<!-- Q13 -->
    <li style="padding-bottom: 0.5em"><a name="q13"></a>
      <p><b>Как использовать настройки ресурсов GTK+ 2 с
        приложениями GTK+ 2 при работе вне оболочки GNOME?</b></p>

<!-- A13 -->
      <p>Приложения GNOME 2 получают свои ресурсы GTK+ 2 из тем и
        соответствующих механизмов тем.  Если вы хотите запустить приложение
        GTK+ 2 вне оболочки GNOME, то вам нужно создать файл с именем
	<tt>~/.gtkrc-2.0</tt>.</p>

      <p>Чтобы использовать виджеты из темы GTK+ 2 при работе вне оболочки
        GNOME, просто выполните включение (<tt>include</tt>) файла
        <tt>gtk-2.0/gtkrc</tt> в ваш <tt>~/.gtkrc-2.0</tt>. Например:

        <pre>include "/usr/X11R6/share/themes/Crux/gtk-2.0/gtkrc"</pre>

      <p>Если вам это нравится, то вы можете использовать одну и ту же тему
        GTK+ 1.2 как для приложений GTK+ 1.2, так и GTK+ 2, что даст вашим
        программам GTK+ единый вид.  В большинстве случаев вы можете перенести
        (с некоторыми оговорками) свои настройки из вашего
        файла <tt>~/.gtkrc</tt> (используемого в GTK+ 1.2).</p>

      <ol>
        <li>Если у вас присутствуют ссылки на какой либо механизм тем, вы
          должны обеспечить, что этот механизм соответствует используемому в
          GTK+ 2.  В противном случае удалите запись о механизмах.</li>

	<li>Задание шрифтов по умолчанию не должно находиться в каких бы то ни
          было блоках <tt>style</tt>, а должно выполняться ключевым словом
	  <tt>gtk-font-name</tt>.  Например:

	  <pre>gtk-font-name = "Verdana 11"</pre>
        </li>
      </ol>
    </li>

<!-- Q14 -->
    <li style="padding-bottom: 0.5em"><a name="q14"></a>
      <p><b>Как выполнить настройки для приложений GNOME 1.4 при
      работе в GNOME &gnomever;?</b></p>

<!-- A14 -->
      <p>Установите <tt>sysutils/gnomecontrolcenter</tt>, затем из командной
        строки запустите <tt>gnomecc</tt> для работы с центром управления GNOME
        1.4.</p>
    </li>

<!-- Q15 -->
    <li style="padding-bottom: 0.5em"><a name="q15"></a>
      <p><b>Nautilus-cd-burner не позволяет записывать CD.  Как
        это исправить?</b></p>

<!-- A15 -->
      <p>Nautilus-cd-burner не может выполнять запись на устройства записи
        CD/DVD, если поддержка этих устройств не включена в ядре, или если
        права доступа к файлам этих устройств не позволяют выполнять запись.
        Nautilus-cd-burner работает с устройствами записи CD/DVD посредством
        подсистемы SCSI CAM.  поэтому вы должны удостовериться, что в вашем
        ядре настроено следующее:</p> 

      <pre>
device          scbus
device          cd
device          pass
      </pre>

      <p>При использовании устройств записи CD/DVD с интерфейсом ATAPI вы 
        должны также проверить, что в ядре имеются следующие настройки:</p>

      <pre>
device		atapicam
      </pre>

      <p>Для того, чтобы понять, какое устройство CD/DVD вы будете
        использовать, запустите следующую команду, работая как пользователь
	root:</p>

      <pre>
# camcontrol devlist
      </pre>

      <p>Выдача будет выглядеть примерно следующим образом:</p>

      <pre>
&lt;QSI CDRW/DVD SBW-242 UD22&gt;		at scbus1 target 0 lun 0 (cd0,pass0)
      </pre>

      <p>Важны устройства, перечисленные в конце в скобках.  Вы должны
        удостовериться, что файлы в каталоге <tt>/dev</tt> для этих устройств
        доступны для записи пользователям, которые будут использовать
        nautilus-cd-burner.  Кроме этих устройств, пользователям
        nautilus-cd-burner должны быть доступны для записи и устройства
        <tt>/dev/xpt*</tt>.  Следующие настройки в файле
        <tt>/etc/devfs.conf</tt> приведут к желаемому результату при
        использовании вышеперечисленных устройств (<b>NB:</b> 
        <tt>devfs.conf</tt> поддерживается только во FreeBSD 5.x):</p>

      <pre>
perm    acd0    0666
perm    cd0     0666
perm    xpt0    0666
perm    pass0   0666
      </pre>

      <p>Во FreeBSD 4.x вы можете просто задать права доступа к файлу
        устройства, и они останутся такими же после перезагрузки.  Заметьте,
        что во FreeBSD 4.x вы должны использовать файлы устройств типа 'c'
        (к примеру, <tt>acd0c</tt>, <tt>cd0c</tt> и так далее).</p>
    </li>

<!-- Q16 -->
    <li style="padding-bottom: 0.5em"><a name="q16"></a>
      <p><b>Как добавить новые сеансы GDM?</b></p>

<!-- A16 -->
      <p>Способы добавления сеансов GDM в GNOME 2.2 и &gnomever; значительно
        отличаются.  Теперь для того, чтобы добавить новый сеанс, вы должны
        создать файл <tt>.desktop</tt>, в котором содержится информация о
        параметрах сеанса.  Файлы сеансов располагаются в каталоге
        <tt>/usr/X11R6/etc/dm/Sessions</tt>.  Например, для добавления сеанса
        KDE, создайте файл в <tt>/usr/X11R6/etc/dm/Sessions</tt> с именем
	<tt>kde.desktop</tt>.  Этот файл должен содержать следующее:</p>

      <pre>
[Desktop Entry]
Encoding=UTF-8
Name=KDE
Comment=This session logs you into KDE
Exec=/usr/local/bin/startkde
TryExec=/usr/local/bin/startkde
Icon=
Type=Application
      </pre>

      <p>После создания этого файла перезапустите GDM, и в меню
        <em>Sessions</em> появится ссылка на <b>KDE</b>.</p>
    </li>
  </ol>

  &footer;

  </body>
</html>
