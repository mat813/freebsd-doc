<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" [
<!ENTITY base CDATA "../..">
<!ENTITY email 'freebsd-qa'>
<!ENTITY date "$FreeBSD: www/en/releases/5.1R/todo.sgml,v 1.19 2003/04/25 22:42:12 rwatson Exp $">
<!ENTITY title "FreeBSD 5.1 Open Issues">
<!ENTITY % includes SYSTEM "../../includes.sgml"> %includes;
<!ENTITY % developers SYSTEM "../../developers.sgml"> %developers;
]>

<html>
&header;

<h1>Open Issues</h1>

<p>This is a list of open issues that need to be resolved for FreeBSD
  5.1.  If you have any updates for this list, please e-mail
  re@FreeBSD.org.</p>

<h3>Must Resolve Issues for 5.1-RELEASE</h3>

<table border=1 width="100%">
  <tr><th>Issue</th><th>Status</th><th>Responsible</th><th>Description</th>
      </tr>

  <tr>
  <td>Fresh ACPI-CA import</td>
  <td>In Progress</td>
  <td>&a.njl;</td>
  <td>The last ACPI-CA import happened in Oct 2002.  Vendor releases since then
    address various bugs that have also plagued FreeBSD 5.0 users.</td>
  </tr>

  <tr>
  <td>nullfs deadlocks</td>
  <td>--</td>
  <td>--</td>
  <td>&a.kris; reports deadlocks involving the use of nullfs in the bento
    environment: buildworld -j4 with src and obj mounted via nullfs; the gcc
    processes eventually deadlocked in the ufs state.  DDB traceback
    showed two different codepaths.  I've just repeated this, so the bug
    still exists.</td>
  </tr>

  <tr>
  <td>SMP double fault</td>
  <td>--</td>
  <td>--</td>
  <td>&a.kris; reports that Bento (SMP machine) is regularly crashing
    with a double fault, or just locking up solidly (cannot break to DDB
    on the console).  This may be hardware-related, though, because
    bento also panicked recently with an NMI.  I'm currently running it
    UP to see if the problems persist.  &a.jake; also suggested increasing
    the size of the kernel stack in case that is the cause of the double
    faults.</td>
  </tr>

  <tr>
  <td>Spurious alpha panics</td>
  <td>--</td>
  <td>--</td>
  <td>&a.kris; reports that he has seen several unique panics on the
    alpha machines, but since gdb -k doesn't work on alpha I haven't
    been able to get more than a DDB traceback.  No-one has looked
    into them.</td>
  </tr>

  <tr>
    <td>gdb -k doesn't work on alpha</td>
    <td>--</td>
    <td>&a.mp;</td>
    <td>gdb -k doesn't work on alpha</td>
  </tr>

  <tr>
  <td>TIMEWAIT panic for network labeled MAC policy modules</td>
  <td>In progress</td>
  <td>&a.rwatson;</td>
  <td>Due to TCP state efficiency improvements in the TIMEWAIT state,
    it's now possible for the PCB socket pointer to be NULL in
    situations it previously wasn't.  As a result, TCP responses
    generated in the TIMEWAIT state may lack properly initialized
    MAC labels, resulting in panics for network labeled MAC policies.
    A fix is current in testing.</td>
  </tr>

  <tr>
  <td>ipfw/ipfw2 alignment issues on alpha/sparc64</td>
  <td>In progress</td>
  <td>&a.luigi;</td>
  <td>There are reports of alignment problems with ipfw and/or ipfw2
    on 64-bit platforms (specifically alpha and sparc64).</td>
  </tr>

  <tr>
  <td>ia64 stability</td>
  <td>--</td>
  <td>--</td>
  <td>&a.kris; reports high instability of 5.0-CURRENT on ia64
    machines, such as the pluto* machines.  These problems need to be
    fixed in order to get a successful package build.</td>
  </tr>

  <tr>
  <td>gcc sparc64 problems</td>
  <td>--</td>
  <td>--</td>
  <td>&a.kris; reports that there is a gcc bug on sparc64 that
    prevents the build of XFree86-4-libraries.  &a.kan; is working on
    a gcc 3.3 patchset for test.</td>
  </tr>

  <tr>
    <td>ia64 sio support</td>
    <td>In progress</td>
    <td>&a.marcel;, &a.imp;</td>
    <td>ia64 serial console support is not currently functional,
      and requires a reworking of the sio support to improve
      platform independence and bus handling.</td>
  </tr>

  <tr>
    <td>MAC Framework devfs path fixes</td>
    <td>In progress</td>
    <td>&a.rwatson;</td>
    <td>&a.green; has submitted patches to improve the consistency
      of the pathnames passed into the MAC Framework devfs labeling
      entry points.  These patches need to be thoroughly reviewed
      and tested, then merged.</td>
  </tr>

  <tr>
    <td>MAC Framework locking performance improvements</td>
    <td>In progress</td>
    <td>&a.rwatson;</td>
    <td>MAC Framework synchronization currently costs two mutex lock
      and unlock operations for each entry point, even if no
      dynamically loadable/unloadable policies are present.  Patches
      are currently being tested that halve this locking cost when
      dynamic policies are not loaded.</td>
  </tr>
</table>

<h3>Desired Features for 5.1-RELEASE</h3>

<table border=1 width="100%">
  <tr><th>Issue</th><th>Status</th><th>Responsible</th><th>Description</th>
      </tr>

  <tr>
  <td>a.out toolchain port</td>
  <td>--</td>
  <td>--</td>
  <td>A.out support in the base system was reduced; the removed build
    chain components should be made into a port.</td>
  </tr>

  <tr>
  <td>Race conditions in truss</td>
  <td>Errata candidate</td>
  <td>&a.robert;</td>
  <td>Truss appears to contain a race condition during the start-up of
    debugging, which can result in truss failing to attach to the process
    before it exits.  The symptom is that truss reports that it cannot
    open the procfs node supporting the process being debugged.  A bug
    also appears to exist where in truss will hang if execve() returns
    ENOENT.  A further race appears to exist in which truss will return
    "PIOCWAIT: Input/output error" occasionally on startup.  The fix
    for this sufficiently changes process execution handling that we
    will defer the fix to post-5.0 and consider this errata.</td>
  </tr>

  <tr>
    <td>KSE support for sparc64, alpha, ia64</td>
    <td>--</td>
    <td>&a.jake;, --, --</td>
    <td>Currently, the MD elements of KSE are present only for the i386
      platform, limiting use of KSE to the i386 platform.  It is highly
      desirable to make KSE available on non-i386 platforms for
      5.1-RELEASE so that KSE can see more broad exposure, and the
      performance benefits of KSE can be visible to users of the
      64-bit FreeBSD architectures.</td>
  </tr>

</table>

<h3>Documentation items that must be resolved for 5.1</h3>

<table border=1 width="100%">
  <tr><th>Issue</th><th>Status</th><th>Responsible</th><th>Description</th>
      </tr>

  <tr>
  <td>Documentation rottage: S/Key</td>
  <td>In progress</td>
  <td>--</td>
  <td>We now use OPIE instead of S/Key.  The handbook doesn't cover
    OPIE as well as it covers S/Key.</td>
  </tr>

  <tr>
  <td>Documentation wanted: gdbe</td>
  <td>In progress</td>
  <td>Lucky Green</td>
  <td>5.0 includes GDBE, supporting encryption of swap and storage.
    It would be nice if that was documented in the handbook.</td>
  </tr>

  <tr>
  <td>Early Adopters Guide</td>
  <td>--</td>
  <td>--</td>
  <td>The Early Adopters Guide for 5.0 needs to be updated before it
    can be re-released for 5.1.</td>
  </tr>

  <tr>
  <td>ia64 Hardware Notes</td>
  <td>--</td>
  <td>--</td>
  <td>The hardware notes for ia64 needs some large infusions of text.
    They probably haven't been synched with reality for awhile.</td>
  </tr>
</table>

<h3>Areas requiring immediate testing</h3>

<table border=1 width="100%">
  <tr><th>Issue</th><th>Status</th><th>Responsible</th><th>Description</th>
      </tr>

  <tr>
  <td>iir driver fails to probe disks</td>
  <td>--</td>
  <td>--</td>
  <td>During the install, the iir controller appears to correctly
    probe, but finds no disk devices.  The card in question is an
    Intel srcu32 RAID controller with 32Mb RAM, Firmware revision
    2.33.01.  Intel developers have released an update driver, which
    has recently been adapted and imported into 5-CURRENT, and must
    be tested.</td>
  </tr>

  <tr>
  <td>PAE support for i386</td>
  <td>--</td>
  <td>--</td>
  <td>PAE support allows the use of up to 64GB of RAM on Pentium Pro and above
    systems.  Virtual addresses are still constrained to 32-bits.</td>
  </tr>

  <tr>
  <td>lazy context switching for i386</td>
  <td>--</td>
  <td>--</td>
  <td>Lazy Context Switching allows for faster context switches and should
    mitigate the some of the latency introduced with interrupt threads and
    GEOM kernel threads.  Enabled with the LAZY_SWITCH option.</td>
  </tr>

  <tr>
  <td>if_wi problems on Lucent hardware</td>
  <td>--</td>
  <td>--</td>
  <td>The recently upgraded if_wi driver is more tuned to Prism hardware
    than to Lucent hardware, resulting in system lockups and poor performance
    when using Lucent hardware.  These problems are believed to be fixed
    but more testing is welcome.</td>
  </tr>
  
  <tr>
    <td>No console (term) if smbus is enable in the kernel</td>
    <td>--</td>
    <td>--</td>
    <td>There are reports that kernels build with smbus, viapm, and smb
      devices may not properly probe and support the system console
      following boot.</td>
  </tr>

  <tr>
  <td>UFS2 as installation, newfs default</td>
  <td>--</td>
  <td>&a.rwatson;</td>
  <td>For 5.1-RELEASE, the default file system type for newly created
    file systems is UFS2 rather than UFS1.  newfs(8) and sysinstall(8)
    have been updated to use this new default.  Testing to make sure all
    goes well after the change (committed on April 20, 2003) is
    vital.</td>
  </tr>

  <tr>
  <td>wait4 "impossible" mutex panic</td>
  <td>--</td>
  <td>&a.tjr;</td>
  <td>&a.kris; reports mutex panics in wait4 in the bento environment:
    "Impossible" mutex panic in wait4() (reported to -current a while
    ago).  Believed to be related to (and fixed along with) uidinfo
    "impossible" panic below.</td>
  </tr>

  <tr>
  <td>uidinfo "impossible" panic</td>
  <td>--</td>
  <td>&a.tjr;</td>
  <td>&a.kris; reports that there appears to be a resource leak of
    uidinfo reference counts that is causing the gohan machines to panic
    after about 18 days of load.  &a.tjr; has committed a fix that is
    believed to solve the problem.</td>
  </tr>

  <tr>
  <td>NSSwitch support</td>
  <td>--</td>
  <td>&a.nectar;</td>
  <td>Support for pluggable directory services using NSS, including
    adaptations of current directory services (local databases, NIS),
    and support for new services (LDAP, Active Directory, etc).
    This change has been committed, and requires broader testing.</td>
  </tr>

</table>

    &footer;

  </body>
</html>
