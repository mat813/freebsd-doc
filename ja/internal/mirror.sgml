<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN" [
<!ENTITY base CDATA "..">
<!ENTITY date "$Date: 1998-09-10 18:02:33 $">
<!ENTITY title "Mirroring the FreeBSD Web Pages">
<!ENTITY % includes SYSTEM "../includes.sgml"> %includes;
]>
<!-- $Id: mirror.sgml,v 1.4 1998-09-10 18:02:33 motoyuki Exp $ -->
<!-- The FreeBSD Japanese Documentation Project -->
<!-- Original revision: 1.7 -->

<html>
&header;

<p><tt>www.freebsd.org</tt>にあるFreeBSDのWebページをミラーする
ことができます(また, 奨励されてもいます). ミラーを行うには,
<em>rsync</em>というプログラムを入手してWebサーバにインストール
する必要があります. RsyncはAustralian National Universityの
Andrew TridgellとPaul Mackerrasによって書かれた, 画期的な
ツリー同期用のプログラムです. これを非特権のクライアント-サーバ
モードで動作するよう, Warren Toomeyが改めたものがあります.</p>

<H2>Rsyncをインストールする</H2>

<p>ビルドとインストールを行うために, 以下のコマンドを実行して
下さい.</p>

<pre>
 % cd /usr/ports/net/rsync
 % make all install
 % rehash	(cshユーザ用)
</pre>

<H2>Rsyncを走らせる</H2>

<p>ミラーするFreeBSDのwebページを<tt>/usr/FreeBSD-mirror/data</tt>
に置き, ユーザ`fred'に所有させたい場合, ユーザ`fred'になって
以下のコマンドを実行してください</p>

<pre>
 % rsync --client -avz www.freebsd.org:www /usr/FreeBSD-mirror/data
</pre>

<p>こうすればFreeBSDのwebページを<tt>/usr/FreeBSD-mirror/data</tt>
にミラーすることができます. fredのcrontabにこのコマンドを
書き込めば, 一日一回このコマンドを実行することもできるように
なります. www.freebsd.orgは, 毎日カリフォルニア時間の4:30amに
ページを更新しています.</p>

<p>何かの理由でrsyncを使いたくない場合でも, よくあるFTPを使ったミラー
用のユーティリティを使って, 
<a href="ftp://ftp.freebsd.org/pub/FreeBSD/FreeBSD-current/www">
基幹となるFTPサイトのコピー</a>を手にいれることによって, 簡単に
ミラーを行うことができます.</p>

<H2>Rsyncのパフォーマンスを調整する</H2>

<p><tt>www.freebsd.org</tt>以下の階層には, いくつかgzipをかけられた
tarファイルがありますが, Rsyncはこれらのファイルを上手に処理することが
できません. gzipされたファイルが変更された場合, 個々のtarファイルを
すべて転送し直すことになるからです. これらのファイルはローカルの環境で簡単に
作れますから, <em>rsync</em>が取ってこない
ようにしてしまいましょう. そうするには, 以下のコマンドをユーザ`fred'
になって実行してください.</p>

<pre>
 % rsync --client -avz --exclude '*.tar.gz' www.freebsd.org:www /usr/FreeBSD-mirror/data
</pre>

<p><em>rsync</em>のパフォーマンスに劇的な進歩がみられたことと
思います. (tarファイルを処理するもっと良いメカニズムが
確立される必要があるでしょうが.)

<H2>Rsyncに関する更なる情報</H2>

<p><em>rsync</em>をひととおり使えるようになったのなら,
以下のファイルを読んでおくことをおすすめします.</p>

<ul>
<li>README
<li>rsyncのマニュアル, rsync.1
<li>tech_report.ps
</ul>

<p><em>rsync</em>に関して何か質問がある場合は, プログラムの作者に
質問するか, rsyncのメーリングリストに入ってください(両方とも
READMEの中で説明してあります).</p>

&footer;
